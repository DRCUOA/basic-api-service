@startuml Architecture Overview - Layered Architecture Pattern

!define RECTANGLE class

package "Presentation Layer (API)" {
  [Express App\nindex.js] as ExpressApp
  [Routes Factory\nroutes.js] as Routes
  [Task Controller Factory\ntaskController.js] as ControllerFactory
  [Task Controller Instance] as Controller
}

package "Domain/Business Layer" {
  [Task Service Factory\ntaskService.js] as ServiceFactory
  [Task Service Instance] as Service
}

package "Data Access Layer" {
  [Tasks DAO\ntasksDao.js] as DAO
  [Task Model\nTask.js] as TaskModel
  [Database Runtime\ndata/database.js] as Database
  [Database Config CLI\ndata/config/database.js] as DatabaseConfig
}

package "Cross-Cutting Concerns" {
  [Logger\nutils/logger.js] as Logger
}

database "PostgreSQL Database" {
  [tasks table] as TasksTable
}

ExpressApp --> Routes : "creates router with\n/api prefix"
ExpressApp --> Database : "getSequelize()\ntestConnection()\nverifySchema()"
ExpressApp --> ControllerFactory : "createTaskController()"
ExpressApp --> ServiceFactory : "createTaskService()"
Routes --> Controller : "routes HTTP requests"
Controller --> Service : "calls business logic"
Controller --> Logger : "logs requests/responses"
Service --> DAO : "accesses data"
Service --> Logger : "logs operations"
DAO --> TaskModel : "uses Sequelize model"
DAO --> Logger : "logs data access"
Database --> TaskModel : "provides Sequelize instance"
DatabaseConfig ..> Database : "CLI config only\n(sequelize-cli)"
TaskModel --> TasksTable : "maps to"

note right of ExpressApp
  Entry point
  Sets up Express server
  Configures JSON middleware
  Establishes DB connection
  Verifies schema exists
  Enforces migration-only schema
  Factory pattern for DI
end note

note right of Controller
  Factory function pattern
  Handles HTTP requests/responses
  Error handling
  Status codes
  All CRUD methods implemented:
  - listTasks
  - createTask
  - updateTasks
  - deleteTasks
end note

note right of Service
  Factory function pattern
  Business logic layer
  Orchestrates operations
  Validates business rules
  All CRUD methods implemented:
  - listTasks
  - createTask
  - updateTasks
  - deleteTasks
end note

note right of DAO
  Data Access Object pattern
  Uses Sequelize ORM
  All methods implemented:
  - retrieveAllTasks
  - retrieveTaskById
  - createTask
  - updateTask
  - deleteTask
  Connects to PostgreSQL
end note

note right of Database
  Sequelize runtime configuration
  Connection pooling enabled
  sync() method poisoned
  Migration-only schema control
  verifySchema() checks table exists
  Test environment guardrails
end note

@enduml
